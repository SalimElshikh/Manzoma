@model  ElecWarSystem.Models.We7daRa2eeseya
@using ElecWarSystem.Models;
@using ElecWarSystem.Models
<link rel="stylesheet" href="~/Content/UnitData.css" />
<link rel="stylesheet" href="~/Content/aside.css" />
<link rel="stylesheet" href="~/Content/second-layout.css" />
<link rel="stylesheet" href="~/Content/UnitData.css" />
<script src="~/Scripts/UnitDataHelper.js"></script>
<div class="popup" id="draggablePopup">
    <div class="popup-content">
        <span class="popup-close" onclick="closePop()">&times;</span>
        <h2>إضافة/تعديل بيانات الفرد</h2>
        <div class="form-group">
            <label for="FardDetails-Raqam3askary">الرقم العسكرى</label>
            <input type="text" id="FardDetails-Raqam3askary" class="form-control" oninput="disableBtn()">
        </div>
        <div class="form-group">
            <label for="FardDetails-Rotba">الرتبة</label>
            <select id="FardDetails-Rotba" class="form-control" oninput="disableBtn()">
                @foreach (var rotba in ViewBag.Rotbas)
                {
                    <option value="@rotba.ID">@rotba.RotbaName</option>
                }
            </select>
        </div>
        <div class="form-group">
            <label for="FardDetails-name">الإسم</label>
            <input type="text" id="FardDetails-name" class="form-control" oninput="disableBtn()">
        </div>
        <button type="button" class="popup-submit-btn btn btn-primary" onclick="saveFardDetailsChanges()" disabled>حفظ</button>
    </div>
</div>

<div class="container d-flex flex-column">
    <div class="title-div " style="width: 100%">
        <div class="d-flex justify-content-around">
            <img src="~/Images/elecwarIcon2.png" />
            <p style="font-size:50px; font-weight:bold;">@ViewBag.unit.We7daName</p>
            <img src="~/Images/elecwarIcon2.png" />

        </div>
        <p>إدخال بيانات الوحدة</p>
    </div>
    <nav>

        <ul class="links d-flex flex-row justify-content-between align-items-center flex-wrap">
            <li class="@(ViewBag.pg == 1 ? "active" : "")">
                @Html.ActionLink("بيانات قادة الوحدة", "DataEntry", "We7daRa2eeseya", new { pg = 1 }, null)
            </li>
            <li class="@(ViewBag.pg == 5 ? "active" : "")">
                @Html.ActionLink("بيانات قادة الوحدة الفرعية", "DataEntry", "We7daRa2eeseya", new { pg = 5 }, null)
            </li>
            <li class="@(ViewBag.pg == 4 ? "active" : "")">
                @Html.ActionLink("بيانات الجنود", "DataEntry", "We7daRa2eeseya", new { pg = 4 }, null)
            </li>
            <li class="@(ViewBag.pg == 3 ? "active" : "")">
                @Html.ActionLink("بيانات ضباط الصف", "DataEntry", "We7daRa2eeseya", new { pg = 3 }, null)
            </li>
            <li class="@(ViewBag.pg == 2 ? "active" : "")">
                @Html.ActionLink("بيانات الضباط", "DataEntry", "We7daRa2eeseya", new { pg = 2 }, null)
            </li>
        </ul>
    </nav>
    @{
        int j;
        string[] pgContent = new string[] { "بيانات الضباط", "بيانات ضباط الصف", "بيانات الجنود" };
        int pg = ViewBag.pg;
    }
    @switch (pg)
    {
        case 1:
            <h1 class="text">قيادة الوحدة</h1>
            <div class="name-div">
                @using (Html.BeginForm("AddUnitLeadership", "We7daRa2eeseya", FormMethod.Post, new { @enctype = "multipart/form-data" }))
                {
                    <div class="d-flex flex-row">
                        <div class="container">
                            <div class="row">
                                <h2 class="">قائد الوحدة</h2>
                                <div class="form-group ">
                                    @Html.Label("الرقم العسكرى", htmlAttributes: new { @class = "control-label " })

                                    @Html.EditorFor(model => Model.Qa2edWe7da.Raqam3askary, new { htmlAttributes = new { @class = "form-control" } })

                                </div>
                                <div class="form-group ">
                                    @Html.Label("الرتبة", htmlAttributes: new { @class = "control-label " })

                                    @Html.DropDownListFor(model => Model.Qa2edWe7da.RotbaID, new SelectList(ViewBag.Rotbas, "ID", "RotbaName"), new { @class = "form-control" })

                                </div>
                                <div class="form-group ">
                                    @Html.Label("الإسم", htmlAttributes: new { @class = "control-label " })

                                    @Html.EditorFor(model => Model.Qa2edWe7da.FullName, new { htmlAttributes = new { @class = "form-control" } })

                                </div>
                            </div>
                        </div>
                        <hr />
                        <div class="container">
                            <div class="row">
                                <h2>رئيس عمليات الوحدة</h2>
                                <div class="form-group ">
                                    @Html.Label("الرقم العسكرى", htmlAttributes: new { @class = "control-label " })
                                    @Html.EditorFor(model => Model.Ra2ees3ameleyat.Raqam3askary, new { htmlAttributes = new { @class = "form-control" } })

                                </div>
                                <div class="form-group ">
                                    @Html.Label("الرتبة", htmlAttributes: new { @class = "control-label " })
                                    <div class="">
                                        @Html.DropDownListFor(model => Model.Ra2ees3ameleyat.RotbaID, new SelectList(ViewBag.Rotbas, "ID", "RotbaName"), new { @class = "form-control" })
                                        @Html.ValidationMessage("UnitOperChRotba", "", new { @class = "text-danger" })
                                    </div>

                                </div>
                                <div class="form-group">
                                    @Html.Label("الإسم", htmlAttributes: new { @class = "control-label " })
                                    <div class="">
                                        @Html.EditorFor(model => Model.Ra2ees3ameleyat.FullName, new { htmlAttributes = new { @class = "form-control" } })
                                        @Html.ValidationMessage("UnitOperChName", "", new { @class = "text-danger" })
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                    <hr />
                    <div class="form-group d-flex flex-row">
                        @Html.Label("عدد الوحدات الفرعية", htmlAttributes: new { @class = "control-label fs-5 text-center" })
                        <input class="form-control" type="number" value="@Model.We7daFar3eya.Count" name="SmallUnitCount" max="3" , min="0" style="margin-right:20px" />

                    </div>
                    <button type="submit" class="button" style="font-size:16px;">
                        <span class="glyphicon glyphicon-save"></span>
                        حفظ
                    </button>
                }
            </div>
            <hr />
            break;
        //----------------------------------------------------------------------------------------------
        case 5:
            int SmallUnitCount = (ViewBag.suCount >= 3) ? 3 : ViewBag.suCount;
            if (TempData["SmallUnitCount"] != null)
            {
                SmallUnitCount = Math.Max(SmallUnitCount, int.Parse(TempData["SmallUnitCount"].ToString()));
            }

            string[] units = new string[] { "الكتيبة الأولى", "الكتيبة الثانية", "الكتيبة الثالثة" };
            if (SmallUnitCount == 0)
            {
                <h4 id="ifNoUnits">لا توجد وحدات فرعية</h4>
            }
            else
            {
                <div class="name-div  col-lg-12 ">
                    @using (Html.BeginForm("AddSmallUnit", "We7daRa2eeseya", FormMethod.Post, new { @enctype = "multipart/form-data" }))
                    {
                        for (int i = 0; i < SmallUnitCount; i++)
                        {
                            string ucRotba = "0", uocRotba = "0";
                            if (i >= Model.We7daFar3eya.Count)
                            {
                                Model.We7daFar3eya.Add(new We7daFar3eya());
                            }
                            else
                            {
                                ucRotba = Model.We7daFar3eya[i].Qa2edWe7da.RotbaID.ToString();
                                uocRotba = Model.We7daFar3eya[i].Ra2ees3ameleyat.RotbaID.ToString();
                            }
                            <h2 class="text">قيادة @units[i]</h2>
                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                <div class="container">
                                    <div class="row">
                                        <h3 class="col-lg-12 col-md-12 col-sm-12 col-xs-12">قائد @units[i]</h3>
                                        <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                            <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4"></div>
                                            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
                                                @Html.EditorFor(model => Model.We7daFar3eya[i].Qa2edWe7da.Raqam3askary, new { htmlAttributes = new { @class = "form-control" } })
                                            </div>
                                            @Html.Label("الرقم العسكرى", htmlAttributes: new { @class = "control-label col-lg-2 col-md-2 col-sm-2 col-xs-2" })
                                        </div>
                                        <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                            <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4"></div>
                                            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
                                                @Html.DropDownListFor(model => Model.We7daFar3eya[i].Qa2edWe7da.RotbaID, new SelectList(ViewBag.Rotbas, "ID", "RotbaName", ucRotba), new { @class = "form-control" })
                                                @Html.ValidationMessageFor(model => Model.We7daFar3eya[i].Qa2edWe7da.RotbaID, "", new { @class = "text-danger" })
                                            </div>
                                            @Html.Label("الرتبة", htmlAttributes: new { @class = "control-label col-lg-2 col-md-2  col-sm-2 col-xs-2" })
                                        </div>
                                        <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                            <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4"></div>
                                            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
                                                @Html.EditorFor(model => Model.We7daFar3eya[i].Qa2edWe7da.FullName, new { htmlAttributes = new { @class = "form-control" } })
                                                @Html.ValidationMessageFor(model => Model.We7daFar3eya[i].Qa2edWe7da.FullName, "", new { @class = "text-danger" })
                                            </div>
                                            @Html.Label("الإسم", htmlAttributes: new { @class = "control-label col-lg-2 col-md-2  col-sm-2 col-xs-2" })
                                        </div>
                                    </div>
                                </div>
                                <div class="container background">
                                    <div class="row">
                                        <h3 class="col-lg-12 col-md-12 col-sm-12 col-xs-12">رئيس عمليات @units[i]</h3>
                                        <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                            <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4"></div>
                                            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
                                                @Html.EditorFor(model => Model.We7daFar3eya[i].Qa2edWe7da.Raqam3askary, new { htmlAttributes = new { @class = "form-control" } })
                                            </div>
                                            @Html.Label("الرقم العسكرى", htmlAttributes: new { @class = "control-label col-lg-2 col-md-2 col-sm-2 col-xs-2" })
                                        </div>
                                        <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                            <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4"></div>
                                            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
                                                @Html.DropDownListFor(model => Model.We7daFar3eya[i].Ra2ees3ameleyat.RotbaID, new SelectList(ViewBag.Rotbas, "ID", "RotbaName", uocRotba), new { @class = "form-control" })
                                                @Html.ValidationMessage("UnitOperChRotba" + @i, "", new { @class = "text-danger" })
                                            </div>
                                            @Html.Label("الرتبة", htmlAttributes: new { @class = "control-label col-lg-2 col-md-2 col-sm-2 col-xs-2" })
                                        </div>
                                        <div class="form-group col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                            <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4"></div>
                                            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6">
                                                @Html.EditorFor(model => Model.We7daFar3eya[i].Ra2ees3ameleyat.FullName, new { htmlAttributes = new { @class = "form-control" } })
                                                @Html.ValidationMessage("UnitOperChName" + @i, "", new { @class = "text-danger" })
                                            </div>
                                            @Html.Label("الإسم", htmlAttributes: new { @class = "control-label col-lg-2 col-md-2 col-sm-2 col-xs-2" })
                                        </div>
                                    </div>
                                </div>
                                <hr />
                            </div>
                        }
                        <button type="submit" class="export-btn" style="font-size:16px;">

                            حفظ
                        </button>
                    }
                </div>
            }
            break;
        //------------------------------------------------------------------------------------------------------------
        case 2:
        case 3:
        case 4:
            <h2 class="text">@pgContent[@ViewBag.pg - 2]</h2>
            <div class="name-div ">
                <div class="container">
                    <div class="row">

                        <div class="table">
                            <table class="table  table table-striped" id="FardDetailss-table  ">
                                <tr class="header-tr">
                                    <th>م</th>
                                    <th>الرقم العسكرى</th>
                                    <th>@(ViewBag.pg == 2 ? "الرتبة" : "الدرجة") </th>
                                    <th>الإسم</th>
                                    <th></th>
                                </tr>
                                @{
                                    j = 1;
                                }
                                <tbody>
                                    @foreach (FardDetails FardDetails in ViewBag.FardDetails)
                                    {
                                        <tr>
                                            <td>@j</td>
                                            <td>@Html.DisplayFor(modelItem => FardDetails.Raqam3askary)</td>
                                            <td>@Html.DisplayFor(modelItem => FardDetails.Rotba.RotbaName)</td>
                                            <td>@Html.DisplayFor(modelItem => FardDetails.FullName)</td>
                                            <td>
                                                <button class=" pg-2" onclick="updateAfterDelete(@FardDetails.ID, @FardDetails.Rotba.RotbaType)">
                                                    حذف
                                                    <span class="glyphicon glyphicon-remove"></span>
                                                </button>
                                                <label>|</label>
                                                <button class="pg-2" onclick="openFardDetailsPopup(@FardDetails.ID, @FardDetails.Rotba.RotbaType, true)">
                                                    تعديل
                                                    <span class="glyphicon glyphicon-edit"></span>
                                                </button>
                                            </td>
                                        </tr>
                                        j++;
                                    }
                                </tbody>
                            </table>
                            <div class="form-group ">
                                <button class="export-btn" style="font-size:16px;" onclick="openFardDetailsPopup(@ViewBag.unit.ID,  @ViewBag.pg - 1, false)">
                                    <span class="glyphicon glyphicon-plus"></span>
                                    إضافة
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            break;
        default:
            break;
    }

</div>


